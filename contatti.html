<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contatti</title>
    <link rel="stylesheet" href="./assets/css/font.css">
    <link rel="stylesheet" href="./assets/css/global.css">
    <link rel="stylesheet" href="./assets/css/header.css">
    <style>
        .section-1-contacts__row-container {
            position: relative;
            height: 100%;
            display: flex;
            gap: 4rem;
        }

        .section-1-contacts__column-left-container {
            box-sizing: border-box;
            padding-top: 100px;
            border: 4px dashed rgba(64, 0, 255, 0.254);
            height: 100%;
            width: 100%;
        }

        .section-1-contacts__column-left-content {
            box-sizing: border-box;
            height: 100%;
            width: 100%;
        }

        .section-1-contacts__column-right-container {
            box-sizing: border-box;
            border: 4px dashed rgba(255, 0, 89, 0.254);
            height: 100%;
            width: 100%;
            padding: 20px;
        }

        .section-1-contacts__map-container {
            box-sizing: border-box;
            border: 2px dashed rgba(98, 0, 255, 0.468);
            background: url('./assets/svgs/italia-arancione.svg') no-repeat center center;
            background-size: contain;
            width: 100%;
            height: 100%;
            position: relative;
        }

        .map-pin {
            position: absolute;
            height: 16px;
            width: 16px;
            background: url('./assets/svgs/plus-button-fff.svg') no-repeat center center;
            background-size: contain;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .map-pin:hover {
            transform: scale(1.2);
        }

        .map-pin::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('./assets/svgs/plus-button-e846a0.svg') no-repeat center center;
            background-size: contain;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .map-pin.active::after {
            opacity: 1;
        }

        #map-pointer {
            position: absolute;
            left: 1200px;
            top: 0px;
            width: 100px;
            height: 62px;
            background: url('./assets/svgs/shape-2-pink.svg') no-repeat center center;
            background-size: contain;
            transform-origin: center;
            transform: translate(-50%, -50%) rotate(-90deg) scale(1);
            transition: transform 0.5s ease, top 0.5s ease, left 0.5s ease;
            z-index: 10;
        }

        #section-1-contacts__back-btn {
            position: absolute;
            bottom: 0;
            left: -1200px;
        }

        .section-1-contacts-legal-office-container,
        .section-1-contacts-operation-office-container {
            font-family: 'Mundial Thin';
        }

        .section-1-contacts-legal-office-container h3,
        h2,
        .section-1-contacts-operation-office-container h3,
        h2 {
            font-family: 'Mundial Regular';
            margin: 0 0 1rem 0;
        }

        .section-1-contacts-legal-office-container h3,
        .section-1-contacts-operation-office-container h3 {
            font-family: 'Mundial Thin';
        }

        .section-1-contacts-legal-office-container h3,
        .section-1-contacts-operation-office-container h3 {
            text-transform: uppercase;
        }
    </style>
</head>

<body class="page-id-46">

    <div class="outer-app-container">
        <!-- HEADER -->
        <div id="edge-header" class="edge-header">
            <div id="header-logo-container" class="header-logo-container">
                <img class="header-logo-img" src="./assets/svgs/logo.svg" alt="Edge"
                    onClick="window.location = './front-page.html';" style="cursor: pointer;" />
                <h1 class="header-logo-edge">edge</h1>
            </div>
            <div class="header-navigation-links-container">
                <div class="header-navigation-links">
                    <a class="header-navigation-link" href="/a-proposito-di-noi.html">A proposito di noi</a>
                    <a class="header-navigation-link" href="/cosa-facciamo.html">Cosa facciamo</a>
                    <a class="header-navigation-link" href="/over-the-edge.html">Over the Edge</a>
                    <a class="header-navigation-link" href="/il-gruppo.html">Il gruppo</a>
                    <a class="header-navigation-link" href="/contatti.html">Contatti</a>
                    <a class="header-navigation-link" href="#">it <span style="font-family: arial;">|</span> en</a>
                </div>
            </div>
        </div>

        <div class="inner-app-container">
            <div class="section-padded-content section-1-contacts">
                <div class="section-1-contacts__row-container">
                    <div class="section-1-contacts__column-left-container">
                        <div id="section-1-contacts__back-btn" class="btn btn-F69701 color-FFF"
                            onclick="section1AboutUsUnselect()" data-meta-label="true">
                            Back
                        </div>
                        <div class="section-1-contacts__column-left-content">
                            <!-- Default view (no pin selected) -->
                            <div class="section-1-contacts-legal-office-container">
                                <h2>Sede legale</h2>
                                <h3>Milano</h3>
                            </div>
                            <div class="section-1-contacts-operation-office-container">
                                <h2>Sedi operative</h2>
                                <!-- Example of calling movePointerToPin on click -->
                                <h3 onclick="window.movePointerToPinByCity('Milano')">Milano</h3>
                                <h3 onclick="window.movePointerToPinByCity('Verona')">Verona</h3>
                                <h3 onclick="window.movePointerToPinByCity('Casale Monferrato')">Casale monferrato</h3>
                                <!-- etc... -->
                            </div>
                        </div>
                    </div>

                    <div class="section-1-contacts__column-right-container">
                        <div class="section-1-contacts__map-container" id="map-container">
                            <div id="map-pointer"></div>
                            <div class="map-pin" id="map-pin-milan" title="Milan" tabindex="0" role="button"
                                aria-label="Milan"></div>
                            <div class="map-pin" id="map-pin-tourin" title="Tourin" tabindex="0" role="button"
                                aria-label="Tourin"></div>
                            <div class="map-pin" id="map-pin-casale" title="Casale Monferrato" tabindex="0"
                                role="button" aria-label="Casale Monferrato"></div>
                            <div class="map-pin" id="map-pin-mantova" title="Mantova" tabindex="0" role="button"
                                aria-label="Mantova"></div>
                            <div class="map-pin" id="map-pin-verona" title="Verona" tabindex="0" role="button"
                                aria-label="Verona"></div>
                            <div class="map-pin" id="map-pin-ferrara" title="Ferrara" tabindex="0" role="button"
                                aria-label="Ferrara"></div>
                            <div class="map-pin" id="map-pin-padova" title="Padova" tabindex="0" role="button"
                                aria-label="Padova"></div>
                            <div class="map-pin" id="map-pin-calabria" title="Calabria" tabindex="0" role="button"
                                aria-label="Calabria"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section-padded-content section-2-contacts">
                <h1 style="padding: 200px">Lavora con noi</h1>
            </div>

            <div class="section-padded-content">
                <h1 style="padding: 200px">Informazioni</h1>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mapContainer = document.querySelector('.section-1-contacts__map-container');
            const mapPointer = document.getElementById('map-pointer');
            const backBtn = document.getElementById('section-1-contacts__back-btn');

            const originalMapSize = { width: 415, height: 543 };
            const pointerAspectRatio = 0.62;

            const pinsData = [
                {
                    id: 'map-pin-milan',
                    city: 'Milano',
                    originalX: 87,
                    originalY: 95,
                    pointerOffset: 30,
                    pointerRotation: 180
                },
                {
                    id: 'map-pin-tourin',
                    city: 'Torino',
                    originalX: 47,
                    originalY: 95,
                    pointerOffset: 40,
                    pointerRotation: 135
                },
                {
                    id: 'map-pin-casale',
                    city: 'Casale Monferrato',
                    originalX: 70,
                    originalY: 118,
                    pointerOffset: 50,
                    pointerRotation: 45
                },
                {
                    id: 'map-pin-mantova',
                    city: 'Mantova',
                    originalX: 135,
                    originalY: 120,
                    pointerOffset: 40,
                    pointerRotation: 225
                },
                {
                    id: 'map-pin-verona',
                    city: 'Verona',
                    originalX: 135,
                    originalY: 80,
                    pointerOffset: 30,
                    pointerRotation: 135
                },
                {
                    id: 'map-pin-ferrara',
                    city: 'Ferrara',
                    originalX: 165,
                    originalY: 140,
                    pointerOffset: 60,
                    pointerRotation: 90
                },
                {
                    id: 'map-pin-padova',
                    city: 'Padova',
                    originalX: 165,
                    originalY: 100,
                    pointerOffset: 50,
                    pointerRotation: 0
                },
                {
                    id: 'map-pin-calabria',
                    city: 'Reggio Calabria',
                    originalX: 340,
                    originalY: 440,
                    pointerOffset: 40,
                    pointerRotation: 270
                }
            ];

            let activePinId = null;

            function positionPins() {
                const containerWidth = mapContainer.clientWidth;
                const containerHeight = mapContainer.clientHeight;
                const containerRatio = containerWidth / containerHeight;
                const originalRatio = originalMapSize.width / originalMapSize.height;

                let displayedMapWidth, displayedMapHeight;

                if (containerRatio > originalRatio) {
                    displayedMapHeight = containerHeight;
                    displayedMapWidth = displayedMapHeight * originalRatio;
                } else {
                    displayedMapWidth = containerWidth;
                    displayedMapHeight = displayedMapWidth / originalRatio;
                }

                const offsetX = (containerWidth - displayedMapWidth) / 2;
                const offsetY = (containerHeight - displayedMapHeight) / 2;

                pinsData.forEach(pin => {
                    const pinElement = document.getElementById(pin.id);
                    const scaledX = offsetX + (pin.originalX / originalMapSize.width) * displayedMapWidth;
                    const scaledY = offsetY + (pin.originalY / originalMapSize.height) * displayedMapHeight;

                    pinElement.style.left = `${scaledX}px`;
                    pinElement.style.top = `${scaledY}px`;
                });
            }

            function movePointerToPin(pin) {
                const pinElement = document.getElementById(pin.id);
                const pinRect = pinElement.getBoundingClientRect();
                const containerRect = mapContainer.getBoundingClientRect();

                const pinCenterX = pinRect.left - containerRect.left + pinRect.width / 2;
                const pinCenterY = pinRect.top - containerRect.top + pinRect.height / 2;

                const pointerWidth = 100;
                const pointerHeight = pointerWidth * pointerAspectRatio;

                const angleRad = (pin.pointerRotation * Math.PI) / 180;
                const offsetX = Math.cos(angleRad) * pin.pointerOffset;
                const offsetY = Math.sin(angleRad) * pin.pointerOffset;

                mapPointer.style.width = `${pointerWidth}px`;
                mapPointer.style.height = `${pointerHeight}px`;

                mapPointer.style.left = `${pinCenterX + offsetX}px`;
                mapPointer.style.top = `${pinCenterY + offsetY}px`;
                mapPointer.style.transform = `translate(-50%, -50%) rotate(${pin.pointerRotation + 180}deg) scale(.5)`;

                if (activePinId && activePinId !== pin.id) {
                    const previousActivePin = document.getElementById(activePinId);
                    previousActivePin.classList.remove('active');
                }
                pinElement.classList.add('active');
                activePinId = pin.id;

                // Show the back button
                backBtn.style.left = '0';
            }

            // Make the function globally accessible
            window.movePointerToPin = movePointerToPin;

            // Helper to move pointer by city name
            window.movePointerToPinByCity = function (cityName) {
                const pin = pinsData.find(p => p.city.toLowerCase() === cityName.toLowerCase());
                if (pin) {
                    movePointerToPin(pin);
                }
            }

            // Attach event listeners to pins
            pinsData.forEach(pin => {
                const pinElement = document.getElementById(pin.id);
                pinElement.addEventListener('click', () => movePointerToPin(pin));

                pinElement.setAttribute('tabindex', '0');
                pinElement.setAttribute('role', 'button');
                pinElement.setAttribute('aria-label', pin.city || 'Map Pin');

                pinElement.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        movePointerToPin(pin);
                    }
                });
            });

            function section1AboutUsUnselect() {
                // Reset pointer off-screen
                mapPointer.style.left = '1200px';
                mapPointer.style.top = '0px';
                mapPointer.style.transform = 'translate(-50%, -50%) rotate(-90deg) scale(1)';

                // Hide the back button
                backBtn.style.left = '-1200px';

                // Remove active class from the currently active pin, if any
                if (activePinId) {
                    const previousActivePin = document.getElementById(activePinId);
                    if (previousActivePin) {
                        previousActivePin.classList.remove('active');
                    }
                    activePinId = null;
                }
            }

            // Make the deselect function global as well
            window.section1AboutUsUnselect = section1AboutUsUnselect;

            // Initial positioning of pins
            positionPins();

            window.addEventListener('resize', () => {
                positionPins();
                if (activePinId) {
                    const activePin = pinsData.find(pin => pin.id === activePinId);
                    if (activePin) {
                        movePointerToPin(activePin);
                    }
                }
            });
        });
    </script>

</body>
</html>

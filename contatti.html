<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contatti</title>
    <link rel="stylesheet" href="./assets/css/font.css">
    <link rel="stylesheet" href="./assets/css/global.css">
    <link rel="stylesheet" href="./assets/css/header.css">
    <style>
        .section-1-contacts__row-container {
            position: relative;
            height: 100%;
            display: flex;
            gap: 4rem;
        }

        .section-1-contacts__column-left-container {
            box-sizing: border-box;
            padding-top: 100px;
            border: 4px dashed rgba(64, 0, 255, 0.254);
            height: 100%;
            width: 100%;
            position: relative;
        }

        .section-1-contacts__column-left-content {
            box-sizing: border-box;
            height: 100%;
            width: 100%;
            position: relative;
        }

        .section-1-contacts__column-right-container {
            box-sizing: border-box;
            border: 4px dashed rgba(255, 0, 89, 0.254);
            height: 100%;
            width: 100%;
            padding: 20px;
        }

        .section-1-contacts__map-container {
            box-sizing: border-box;
            border: 2px dashed rgba(98, 0, 255, 0.468);
            background: url('./assets/svgs/italia-arancione.svg') no-repeat center center;
            background-size: contain;
            width: 100%;
            height: 100%;
            position: relative;
        }

        .map-pin {
            position: absolute;
            height: 16px;
            width: 16px;
            background: url('./assets/svgs/plus-button-fff.svg') no-repeat center center;
            background-size: contain;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .map-pin:hover {
            transform: scale(1.2);
        }

        .map-pin::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('./assets/svgs/plus-button-e846a0.svg') no-repeat center center;
            background-size: contain;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .map-pin.active::after {
            opacity: 1;
        }

        #map-pointer {
            position: absolute;
            left: 1200px;
            top: 0px;
            width: 100px;
            height: 62px;
            background: url('./assets/svgs/shape-2-pink.svg') no-repeat center center;
            background-size: contain;
            transform-origin: center;
            transform: translate(-50%, -50%) rotate(-90deg) scale(1);
            transition: transform 0.5s ease, top 0.5s ease, left 0.5s ease;
            z-index: 10;
        }

        #section-1-contacts__back-btn {
            position: absolute;
            bottom: 0;
            left: -1200px;
            transition: left 0.5s ease;
            z-index: 300;
        }

        #selected-pin-content {
            position: absolute;
            left: -1200px;
            top: 0;
            transition: left 0.5s ease;
            width: 100%;
        }

        #default-contact-view {
            position: relative;
        }
    </style>
</head>

<body class="page-id-46">

    <div class="outer-app-container">
        <!-- HEADER -->
        <div id="edge-header" class="edge-header">
            <div id="header-logo-container" class="header-logo-container">
                <img class="header-logo-img" src="./assets/svgs/logo.svg" alt="Edge"
                    onClick="window.location = './front-page.html';" style="cursor: pointer;" />
                <h1 class="header-logo-edge">edge</h1>
            </div>
            <div class="header-navigation-links-container">
                <div class="header-navigation-links">
                    <a class="header-navigation-link" href="/a-proposito-di-noi.html">A proposito di noi</a>
                    <a class="header-navigation-link" href="/cosa-facciamo.html">Cosa facciamo</a>
                    <a class="header-navigation-link" href="/over-the-edge.html">Over the Edge</a>
                    <a class="header-navigation-link" href="/il-gruppo.html">Il gruppo</a>
                    <a class="header-navigation-link" href="/contatti.html">Contatti</a>
                    <a class="header-navigation-link" href="#">it <span style="font-family: arial;">|</span> en</a>
                </div>
            </div>
        </div>

        <div class="inner-app-container">
            <div class="section-padded-content section-1-contacts">
                <div class="section-1-contacts__row-container">
                    <div class="section-1-contacts__column-left-container">
                        <div id="section-1-contacts__back-btn" class="btn btn-F69701 color-FFF"
                            onclick="section1ContactsUnselect()" data-meta-label="true">Back
                        </div>

                        <style>
                            .section-1-contacts-offices-container {
                                position: relative;
                                box-sizing: border-box;
                                /* padding-top: 40px; */
                                display: flex;
                                flex-direction: column;
                                align-items: flex-start;
                                justify-content: flex-start;
                                gap: 4rem;
                                background: #00000010;
                                height: 100%;
                            }

                            .section-1-contacts-legal-office-container {
                                position: relative;
                                padding-top: 50px;
                                width: 100%;
                                background: #ff000010;
                            }

                            #legal-office-title-h2 {
                                position: absolute;
                                top: 0px;
                                width: 100%;
                                background: #940a0a10;
                                border: 1px dashed red;
                                transition: all .5s;
                            }

                            #legal-list-of-cities-container {
                                position: absolute;
                                top: 50px;
                                border: 1px dashed red;
                                transition: all .5s;
                            }

                            #legal-list-of-addresses {
                                position: absolute;
                                top: 0px;
                                left: -800px;
                            }

                            .section-1-contacts-operation-office-container {
                                padding-top: 50px;
                                position: relative;
                                width: 100%;
                                background: #00000010;
                            }

                            #operation-office-title-h2 {
                                position: absolute;
                                top: 0px;
                                width: 100%;
                                background: #08760610;
                                border: 1px dashed rgb(17, 122, 12);
                                transition: all .5s;
                            }

                            #operation-list-of-cities-container {
                                position: absolute;
                                top: 50px;
                                background: #2e750a10;
                                border: 1px dashed rgb(17, 122, 12);
                                transition: all .5s;
                            }

                            .office-title-h2 {
                                font-size: 1.8rem;
                                font-family: 'Mundial regular';
                                margin: 0 0 1rem 0;
                            }

                            .office-title-h3 {
                                font-family: 'Mundial Thin';
                                text-transform: uppercase;
                                cursor: pointer;
                                margin: 0 0 1rem 0;
                                width: auto;
                                background: #00000010;
                            }

                            .office-title-h3:last-child {
                                margin-bottom: 0;
                            }
                        </style>

                        <div class="section-1-contacts__column-left-content">
                            <div class="section-1-contacts-offices-container">

                                <div class="section-1-contacts-legal-office-container">
                                    <h2 id="legal-office-title-h2" class="office-title-h2">Sede legale</h2>
                                    <div id="legal-list-of-cities-container">
                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Milano')">
                                            Milano</h3>
                                    </div>
                                    <div id="legal-list-of-addresses">
                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Milano')">
                                            Milano</h3>
                                        <div>Lorem ipsum</div>
                                        <div>+39 345678910</div>
                                    </div>
                                </div>
                                <div class="section-1-contacts-operation-office-container">
                                    <h2 id="operation-office-title-h2" class="office-title-h2">Sedi operative</h2>
                                    <div id="operation-list-of-cities-container">

                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Milano')">
                                            Milano
                                        </h3>
                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Torino')">
                                            Torino
                                        </h3>
                                        <h3 class="office-title-h3"
                                            onclick="window.movePointerToPinByCity('Casale Monferrato')">
                                            Casale Monferrato
                                        </h3>
                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Mantova')">
                                            Mantova
                                        </h3>
                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Verona')">
                                            Verona
                                        </h3>
                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Ferrara')">
                                            Ferrara
                                        </h3>
                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Padova')">
                                            Padova
                                        </h3>
                                        <h3 class="office-title-h3" onclick="window.movePointerToPinByCity('Calabria')">
                                            Calabria
                                        </h3>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="section-1-contacts__column-right-container">
                        <div class="section-1-contacts__map-container" id="map-container">
                            <div id="map-pointer"></div>
                            <div class="map-pin" id="map-pin-milan" title="Milan" tabindex="0" role="button"
                                aria-label="Milan"></div>
                            <div class="map-pin" id="map-pin-tourin" title="Tourin" tabindex="0" role="button"
                                aria-label="Tourin"></div>
                            <div class="map-pin" id="map-pin-casale" title="Casale Monferrato" tabindex="0"
                                role="button" aria-label="Casale Monferrato"></div>
                            <div class="map-pin" id="map-pin-mantova" title="Mantova" tabindex="0" role="button"
                                aria-label="Mantova"></div>
                            <div class="map-pin" id="map-pin-verona" title="Verona" tabindex="0" role="button"
                                aria-label="Verona"></div>
                            <div class="map-pin" id="map-pin-ferrara" title="Ferrara" tabindex="0" role="button"
                                aria-label="Ferrara"></div>
                            <div class="map-pin" id="map-pin-padova" title="Padova" tabindex="0" role="button"
                                aria-label="Padova"></div>
                            <div class="map-pin" id="map-pin-calabria" title="Calabria" tabindex="0" role="button"
                                aria-label="Calabria"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section-padded-content section-2-contacts">
                <h1 style="padding: 200px">Lavora con noi</h1>
            </div>

            <div class="section-padded-content">
                <h1 style="padding: 200px">Informazioni</h1>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mapContainer = document.querySelector('.section-1-contacts__map-container');
            const mapPointer = document.getElementById('map-pointer');
            const backBtn = document.getElementById('section-1-contacts__back-btn');

            const operationH2 = document.getElementById('operation-office-title-h2')
            const legalH2 = document.getElementById('legal-office-title-h2')

            const operationalList = document.getElementById('operation-list-of-cities-container');
            const legalList = document.getElementById('legal-list-of-cities-container');

            let selectedPinContent = null;

            const originalMapSize = { width: 415, height: 543 };
            const pointerAspectRatio = 0.62;

            const pinsData = [
                {
                    id: 'map-pin-milan',
                    city: 'Milano',
                    originalX: 87,
                    originalY: 95,
                    pointerOffset: 30,
                    pointerRotation: 180,
                    sedeLegale: {
                        cityLabel: "Milano",
                        contacts: [
                            {
                                addressString: "Via Example 10, 20100 Milano",
                                email: "milano@edge.com",
                                phone: "+39 345678910"
                            }
                        ]
                    },
                    sedeOperativa: {
                        cityLabel: "Milano",
                        contacts: [
                            {
                                addressString: "Via Operativa 20, 20100 Milano",
                                email: "operativa.milano@edge.com",
                                phone: "+39 3472994421"
                            }
                        ]
                    }
                },
                {
                    id: 'map-pin-tourin',
                    city: 'Torino',
                    originalX: 47,
                    originalY: 95,
                    pointerOffset: 40,
                    pointerRotation: 135,
                    sedeOperativa: {
                        cityLabel: "Torino",
                        contacts: [
                            {
                                addressString: "Piazza Tancredi Galimberti 18 - 10134 Torino",
                                email: "",
                                phone: "+39 3472994421"
                            },
                            {
                                addressString: "Corso Vittorio Emanuele II 162 - 10138 Torino",
                                email: "",
                                phone: "+39 3477492818"
                            }
                        ]
                    }
                },
                {
                    id: 'map-pin-casale',
                    city: 'Casale Monferrato',
                    originalX: 70,
                    originalY: 118,
                    pointerOffset: 50,
                    pointerRotation: 45,
                    sedeOperativa: {
                        cityLabel: "Casale Monferrato",
                        contacts: [
                            {
                                addressString: "Corso Vittorio Emanuele II 162 - 10138 Torino",
                                email: "",
                                phone: "+39 345678910"
                            }
                        ]
                    }
                },
                {
                    id: 'map-pin-mantova',
                    city: 'Mantova',
                    originalX: 135,
                    originalY: 120,
                    pointerOffset: 40,
                    pointerRotation: 225,
                    sedeOperativa: {
                        cityLabel: "Mantova",
                        contacts: [
                            {
                                addressString: "",
                                email: "",
                                phone: "+39 345678910"
                            }
                        ]
                    }
                },
                {
                    id: 'map-pin-verona',
                    city: 'Verona',
                    originalX: 135,
                    originalY: 80,
                    pointerOffset: 30,
                    pointerRotation: 135,
                    sedeOperativa: {
                        cityLabel: "Verona",
                        contacts: [
                            {
                                addressString: "Via del Perlar 37/b – 37135 Verona",
                                email: "",
                                phone: "+39 345678910"
                            }
                        ]
                    }
                },
                {
                    id: 'map-pin-ferrara',
                    city: 'Ferrara',
                    originalX: 165,
                    originalY: 140,
                    pointerOffset: 60,
                    pointerRotation: 90,
                    sedeOperativa: {
                        cityLabel: "Ferrara",
                        contacts: [
                            {
                                addressString: "Via Annibale Zucchini, 57/F – 44122 Ferrara",
                                email: "",
                                phone: "+39 345678910"
                            }
                        ]
                    }
                },
                {
                    id: 'map-pin-padova',
                    city: 'Padova',
                    originalX: 165,
                    originalY: 100,
                    pointerOffset: 50,
                    pointerRotation: 0,
                    sedeOperativa: {
                        cityLabel: "Padova",
                        contacts: [
                            {
                                addressString: "",
                                email: "",
                                phone: "+39 345678910"
                            }
                        ]
                    }
                },
                {
                    id: 'map-pin-calabria',
                    city: 'Reggio Calabria',
                    originalX: 340,
                    originalY: 440,
                    pointerOffset: 40,
                    pointerRotation: 270,
                    sedeOperativa: {
                        cityLabel: "Reggio Calabria",
                        contacts: [
                            {
                                addressString: "Vico S'Anna di Sbarre Inferiori – 89132 Reggio Calabria",
                                email: "",
                                phone: "+39 345678910"
                            }
                        ]
                    }
                }
            ];

            let activePinId = null;

            function positionPins() {
                const containerWidth = mapContainer.clientWidth;
                const containerHeight = mapContainer.clientHeight;
                const containerRatio = containerWidth / containerHeight;
                const originalRatio = originalMapSize.width / originalMapSize.height;

                let displayedMapWidth, displayedMapHeight;

                if (containerRatio > originalRatio) {
                    displayedMapHeight = containerHeight;
                    displayedMapWidth = displayedMapHeight * originalRatio;
                } else {
                    displayedMapWidth = containerWidth;
                    displayedMapHeight = displayedMapWidth / originalRatio;
                }

                const offsetX = (containerWidth - displayedMapWidth) / 2;
                const offsetY = (containerHeight - displayedMapHeight) / 2;

                pinsData.forEach(pin => {
                    const pinElement = document.getElementById(pin.id);
                    const scaledX = offsetX + (pin.originalX / originalMapSize.width) * displayedMapWidth;
                    const scaledY = offsetY + (pin.originalY / originalMapSize.height) * displayedMapHeight;

                    pinElement.style.left = `${scaledX}px`;
                    pinElement.style.top = `${scaledY}px`;
                });
            }

            function createSelectedPinContent(pin) {
                // Create a container
                const container = document.createElement('div');
                container.id = 'selected-pin-content';

                let html = '';

                // Sede Legale
                if (pin.sedeLegale) {
                    html += `<div class="section-1-contacts-legal-office-container">
                                <h2>Sede legale</h2>
                                <h3>${pin.sedeLegale.cityLabel}</h3>`;
                    pin.sedeLegale.contacts.forEach(contact => {
                        if (contact.addressString) html += `<p>${contact.addressString}</p>`;
                        if (contact.email) html += `<p>${contact.email}</p>`;
                        if (contact.phone) html += `<p>${contact.phone}</p>`;
                    });
                    html += `</div>`;
                }

                // Sede Operativa
                if (pin.sedeOperativa) {
                    html += `<div class="section-1-contacts-operation-office-container">
                                <h2>Sedi operative</h2>
                                <h3>${pin.sedeOperativa.cityLabel}</h3>`;
                    pin.sedeOperativa.contacts.forEach(contact => {
                        if (contact.addressString) html += `<p>${contact.addressString}</p>`;
                        if (contact.email) html += `<p>${contact.email}</p>`;
                        if (contact.phone) html += `<p>${contact.phone}</p>`;
                    });
                    html += `</div>`;
                }

                container.innerHTML = html;
                return container;
            }

            function showSelectedPinContent(pin) {
                console.log({ pin })

                operationalList.style.top = '800px'

                if (!pin.sedeLegale) {
                    legalList.style.top = '-800px'
                    legalList.style.top = '-800px'
                    legalH2.style.top = '-800px'
                }

                if (!pin.sedeOperativa) {
                    legalList.style.top = '-800px'
                    legalList.style.top = '-800px'
                    legalH2.style.top = '-800px'
                }
            }

            function section1ContactsUnselect() {
                // LEGAL
                legalH2.style.top = '0px'
                legalList.style.top = '50px'
                
                // OPERATIONS
                operationalList.style.top = '50px'

                // BACK
                backBtn.style.left = '-1200px';

                // MAP
                mapPointer.style.left = '1200px';
                mapPointer.style.top = '0px';
                mapPointer.style.transform = 'translate(-50%, -50%) rotate(-90deg) scale(1)';

                if (activePinId) {
                    const previousActivePin = document.getElementById(activePinId);
                    if (previousActivePin) {
                        previousActivePin.classList.remove('active');
                    }
                    activePinId = null;
                }

                // Remove selected pin content and show default view
                if (selectedPinContent) {
                    selectedPinContent.remove();
                    selectedPinContent = null;
                }
            }

            function movePointerToPin(pin) {
                const pinElement = document.getElementById(pin.id);
                const pinRect = pinElement.getBoundingClientRect();
                const containerRect = mapContainer.getBoundingClientRect();

                const pinCenterX = pinRect.left - containerRect.left + pinRect.width / 2;
                const pinCenterY = pinRect.top - containerRect.top + pinRect.height / 2;

                const pointerWidth = 100;
                const pointerHeight = pointerWidth * pointerAspectRatio;

                const angleRad = (pin.pointerRotation * Math.PI) / 180;
                const offsetX = Math.cos(angleRad) * pin.pointerOffset;
                const offsetY = Math.sin(angleRad) * pin.pointerOffset;

                mapPointer.style.width = `${pointerWidth}px`;
                mapPointer.style.height = `${pointerHeight}px`;

                mapPointer.style.left = `${pinCenterX + offsetX}px`;
                mapPointer.style.top = `${pinCenterY + offsetY}px`;
                mapPointer.style.transform = `translate(-50%, -50%) rotate(${pin.pointerRotation + 180}deg) scale(.5)`;

                if (activePinId && activePinId !== pin.id) {
                    const previousActivePin = document.getElementById(activePinId);
                    previousActivePin.classList.remove('active');
                }
                pinElement.classList.add('active');
                activePinId = pin.id;

                // Show the back button
                backBtn.style.left = '0';

                // Show selected pin content in left column
                showSelectedPinContent(pin);
            }

            // Make the function globally accessible
            window.movePointerToPin = movePointerToPin;

            // Helper to move pointer by city name
            window.movePointerToPinByCity = function (cityName) {
                const pin = pinsData.find(p => p.city.toLowerCase() === cityName.toLowerCase());
                if (pin) {
                    movePointerToPin(pin);
                }
            }

            // Attach event listeners to pins
            pinsData.forEach(pin => {
                const pinElement = document.getElementById(pin.id);
                pinElement.addEventListener('click', () => movePointerToPin(pin));

                pinElement.setAttribute('tabindex', '0');
                pinElement.setAttribute('role', 'button');
                pinElement.setAttribute('aria-label', pin.city || 'Map Pin');

                pinElement.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        movePointerToPin(pin);
                    }
                });
            });

            // Make the deselect function global as well
            window.section1ContactsUnselect = section1ContactsUnselect;

            // Initial positioning of pins
            positionPins();

            window.addEventListener('resize', () => {
                positionPins();
                if (activePinId) {
                    const activePin = pinsData.find(pin => pin.id === activePinId);
                    if (activePin) {
                        movePointerToPin(activePin);
                    }
                }
            });
        });
    </script>

</body>

</html>